@page "/fetchdata"
@using Blazor.AdaptiveCards.Templating;

<h1>Adaptive Card</h1>

<AdaptiveCards Models="@Customers" TemplateSelector="TemplateSelector"></AdaptiveCards>

@*<br/>

<textarea style="width:100%" rows="10" @bind="@schema"></textarea>
<button @onclick="UpdateSchema" class="btn btn-primary">Update schema</button>*@

@code {

    //string schema = "";
    private List<Customer> Customers = new List<Customer>();

    [Inject]
    private IModelTemplateCatalog ModelTemplateCatalog { get; set; }

    protected override void OnInitialized()
    {
        Customers.Clear();

        Customers.Add(new Customer(){FirstName = "Mikael", LastName = "Koskinen"});
        Customers.Add(new Customer(){FirstName = "Another", LastName = "Persn"});
        Customers.Add(new Customer(){FirstName = "Third", LastName = "Customer"});
    }

    public async Task UpdateSchema()
    {
        //        await card.RenderCard(schema);
    }

    public async Task Submit((string, object) data)
    {
    }

    public string TemplateSelector(Customer model)
    {
        if (model.FirstName == "Mikael")
        {
            return ModelTemplateCatalog.Get("Alternative");
        }
        else
        {
            return ModelTemplateCatalog.Get(model.GetType().Name);
        }
    }
}